# Инструкция: Новая русскоязычная новость

## Проблема
Новая новость добавлена в `data/news.json`, но не отображается в UI и акторы не извлечены.

## Причины
1. **Данные загружаются при старте сервера** - нужно перезапустить сервер
2. **Акторы не извлечены** - нужно запустить извлечение акторов
3. **spaCy модель по умолчанию** (`en_core_web_sm`) не поддерживает русский язык

## Решение

### Вариант 1: Перезапуск сервера + извлечение через UI (рекомендуется)

1. **Перезапустите сервер:**
   ```bash
   # Остановите текущий сервер (Ctrl+C)
   # Затем запустите снова:
   ./run.sh
   # или
   uvicorn main:app --host 0.0.0.0 --port 8000 --reload
   ```

2. **После перезапуска откройте UI** и нажмите кнопку **"All Actors"** или **"Hard Reset"**

3. **Извлеките акторы для новой новости:**
   - Найдите новость "Инициализация мирных переговоров..."
   - Используйте кнопку извлечения акторов или API endpoint:
     ```
     POST /api/actors/extract/news/news_6d39500d2052
     ```

### Вариант 2: Использование скрипта

Запустите скрипт для автоматической перезагрузки и извлечения:

```bash
python3 scripts/reload_and_extract.py
```

**Примечание:** Скрипт работает вне сервера, поэтому изменения не будут видны в UI до перезапуска сервера.

### Вариант 3: Использование API напрямую

1. **Перезапустите сервер** (данные загрузятся автоматически)

2. **Извлеките акторы через API:**
   ```bash
   curl -X POST "http://localhost:8000/api/actors/extract/news/news_6d39500d2052?low_conf_threshold=0.75"
   ```

3. **Обновите страницу в браузере**

## Поддержка русского языка

Для лучшего извлечения акторов из русского текста рекомендуется:

1. **Установить русскую модель spaCy:**
   ```bash
   python -m spacy download ru_core_news_md
   ```

2. **Установить переменную окружения:**
   ```bash
   export SPACY_MODEL=ru_core_news_md
   ```
   Или добавьте в `.env` файл:
   ```
   SPACY_MODEL=ru_core_news_md
   ```

3. **Перезапустить сервер**

**Альтернатива:** Если русская модель не установлена, система будет использовать LLM (Gemini) для извлечения акторов из русского текста, что также работает хорошо.

## Ожидаемый результат

После выполнения этих шагов:

1. ✅ Новая новость появится в графе истории "Ukraine Conflict Updates"
2. ✅ Будут извлечены и канонизированы акторы:
   - **Украина** (страна) - русское название будет в алиасах
   - **Россия** (страна) - русское название будет в алиасах
   - **Владимир Путин** (персона) - русское имя будет в алиасах
   - **Владимир Зеленский** (персона) - русское имя будет в алиасах
   - **Дональд Трамп** (персона)
   - **Джо Байден** (персона)
   - **США** (страна) - будет связана с "United States"
3. ✅ На графе при включении связей через акторов новость свяжется с другими новостями истории через общих акторов

## Проверка

После выполнения шагов проверьте:

1. В UI должна появиться третья новость в истории "Ukraine Conflict Updates"
2. В разделе "All Actors" должны появиться новые акторы
3. При включении связей через акторов на графе новость должна быть связана с другими новостями

